<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sinosafe.xszc.report.vo.ReportFoundationMedium" >
	<resultMap id="BaseResultMap" type="java.util.HashMap">
		<result column="UPDATED_USER" property="updatedUser" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="COMMISSION" property="commission" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="REPORT_DAY" property="reportDay" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="PK_ID" property="pkId" jdbcType="INTEGER" javaType="java.lang.Integer" />
 		<result column="CREATED_USER" property="createdUser" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="PARENT_DEPT" property="parentDept" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="DEPT_CODE" property="deptCode" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="C_CHA_TYPE" property="cChaType" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="DEPT_NAME" property="deptName" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="UPDATED_DATE" property="updatedDate" jdbcType="DATE" javaType="java.sql.Timestamp" />
 		<result column="PRIMARY_C_PROD_NAME" property="primaryCProdName" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="CHANNEL" property="channel" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="CREATED_DATE" property="createdDate" jdbcType="DATE" javaType="java.sql.Timestamp" />
 		<result column="C_BSNS_TYP" property="cBsnsTyp" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="T_COMMISSION" property="tCommission" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="RP_PRM_TOTAL_ALL" property="rpPrmTotalAll" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="COMP_TAKE_IN" property="compTakeIn" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="COMP_COMMISION" property="compCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="COMP_REAL_COMMISION" property="compRealCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="FARM_TAKE_IN" property="farmTakeIn" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="FARM_COMMISION" property="farmCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="FARM_REAL_COMMISION" property="farmRealCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="BUSI_TAKE_IN" property="busiTakeIn" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="BUSI_COMMISION" property="busiCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="BUSI_REAL_COMMISION" property="busiRealCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="counts" property="counts" jdbcType="DOUBLE" javaType="java.lang.String" />
 	</resultMap>
 	<!--REPORT_MONTH_BIZ_ORIGIN_NEW-->
 	<resultMap id="bizOriginNew" type="java.util.HashMap">
 	</resultMap>
 	
	
	<resultMap id="BaseResultVo" type="com.sinosafe.xszc.report.vo.ReportFoundationMedium">
		<result column="UPDATED_USER" property="updatedUser" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="COMMISSION" property="commission" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="REPORT_DAY" property="reportDay" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="PK_ID" property="pkId" jdbcType="INTEGER" javaType="java.lang.Integer" />
 		<result column="CREATED_USER" property="createdUser" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="PARENT_DEPT" property="parentDept" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="DEPT_CODE" property="deptCode" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="C_CHA_TYPE" property="cChaType" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="DEPT_NAME" property="deptName" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="UPDATED_DATE" property="updatedDate" jdbcType="DATE" javaType="java.sql.Timestamp" />
 		<result column="PRIMARY_C_PROD_NAME" property="primaryCProdName" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="CHANNEL" property="channel" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="CREATED_DATE" property="createdDate" jdbcType="DATE" javaType="java.sql.Timestamp" />
 		<result column="C_BSNS_TYP" property="cBsnsTyp" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="T_COMMISSION" property="tCommission" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="RP_PRM_TOTAL_ALL" property="rpPrmTotalAll" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="COMP_TAKE_IN" property="compTakeIn" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="COMP_COMMISION" property="compCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="COMP_REAL_COMMISION" property="compRealCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="FARM_TAKE_IN" property="farmTakeIn" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="FARM_COMMISION" property="farmCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="FARM_REAL_COMMISION" property="farmRealCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="BUSI_TAKE_IN" property="busiTakeIn" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="BUSI_COMMISION" property="busiCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="BUSI_REAL_COMMISION" property="busiRealCommision" jdbcType="DOUBLE" javaType="java.lang.Double" />
 		<result column="counts" property="counts" jdbcType="DOUBLE" javaType="java.lang.String" />
 	</resultMap>

	<!-- 查询数据列Sql不转换成对应的Java命名 -->
	<sql id="Base_Column_List" >
		UPDATED_USER,
		COMMISSION,
		REPORT_DAY,
		PK_ID,
		CREATED_USER,
		PARENT_DEPT,
		DEPT_CODE,
		C_CHA_TYPE,
		DEPT_NAME,
		UPDATED_DATE,
		PRIMARY_C_PROD_NAME,
		CHANNEL,
		CREATED_DATE,
		C_BSNS_TYP,
		T_COMMISSION,
		RP_PRM_TOTAL_ALL,
		COMP_TAKE_IN,
		COMP_COMMISION,
		COMP_REAL_COMMISION,
		FARM_TAKE_IN,
		FARM_COMMISION,
		FARM_REAL_COMMISION,
		BUSI_TAKE_IN,
		BUSI_COMMISION,
		BUSI_REAL_COMMISION,
		counts
	</sql>
	
	<!-- 查询数据列Sql换成对应的Java命名 -->
	<sql id="Base_Column_List_JavaName" >
		UPDATED_USER as "updatedUser",
		COMMISSION as "commission",
		REPORT_DAY as "reportDay",
		PK_ID as "pkId",
		CREATED_USER as "createdUser",
		PARENT_DEPT as "parentDept",
		DEPT_CODE as "deptCode",
		C_CHA_TYPE as "cChaType",
		DEPT_NAME as "deptName",
		UPDATED_DATE as "updatedDate",
		PRIMARY_C_PROD_NAME as "primaryCProdName",
		CHANNEL as "channel",
		CREATED_DATE as "createdDate",
		C_BSNS_TYP as "cBsnsTyp",
		T_COMMISSION as "tCommission",
		RP_PRM_TOTAL_ALL as "rpPrmTotalAll",
		COMP_TAKE_IN as compTakeIn,
		COMP_COMMISION as compCommision,
		COMP_REAL_COMMISION as compRealCommision,
		FARM_TAKE_IN as farmTakeIn,
		FARM_COMMISION as farmCommision,
		FARM_REAL_COMMISION as farmRealCommision,
		BUSI_TAKE_IN as busiTakeIn,
		BUSI_COMMISION as busiCommision,
		BUSI_REAL_COMMISION as busiRealCommision,
		counts as counts
	</sql>
	
	<!-- 写入操作的SQL -->
	<sql id="Insert_Base_values">
		#{updatedUser,jdbcType=VARCHAR},
 		#{commission,jdbcType=DOUBLE},
 		#{reportDay,jdbcType=VARCHAR},
 		#{pkId,jdbcType=INTEGER},
 		#{createdUser,jdbcType=VARCHAR},
 		#{parentDept,jdbcType=VARCHAR},
 		#{deptCode,jdbcType=VARCHAR},
 		#{cChaType,jdbcType=VARCHAR},
 		#{deptName,jdbcType=VARCHAR},
 		#{updatedDate,jdbcType=DATE},
 		#{primaryCProdName,jdbcType=VARCHAR},
 		#{channel,jdbcType=VARCHAR},
 		#{createdDate,jdbcType=DATE},
 		#{cBsnsTyp,jdbcType=VARCHAR},
 		#{tCommission,jdbcType=DOUBLE},
 		#{rpPrmTotalAll,jdbcType=DOUBLE}
 	</sql>
 	
 	<sql id="Grouping_id" >
 		having grouping_id(c_bsns_typ,c_cha_type) = 3
 	</sql>
	
	<!-- 查询条件的sql -->
	<sql id="Base_Where_Sql">
		<where>
		<if test="updatedUser != null">
			and UPDATED_USER = #{updatedUser,jdbcType=VARCHAR}
		</if>
		<if test="commission != null">
			and COMMISSION = #{commission,jdbcType=DOUBLE}
		</if>
		<if test="reportDay != null">
			and REPORT_DAY = #{reportDay,jdbcType=VARCHAR}
		</if>
		<if test="pkId != null">
			and PK_ID = #{pkId,jdbcType=INTEGER}
		</if>
		<if test="createdUser != null">
			and CREATED_USER = #{createdUser,jdbcType=VARCHAR}
		</if>
		<if test="parentDept != null and parentDept != '' ">
			and PARENT_DEPT like #{parentDept,jdbcType=VARCHAR} || '%'
		</if>
		<if test="deptCode != null and deptCode != '' ">
			and DEPT_CODE like #{deptCode,jdbcType=VARCHAR} || '%'
		</if>
		<if test="cChaType != null">
			and C_CHA_TYPE = #{cChaType,jdbcType=VARCHAR}
		</if>
		<if test="deptName != null and deptName != '' ">
			and DEPT_NAME like #{deptName,jdbcType=VARCHAR} || '%'
		</if>
		<if test="updatedDate != null">
			and UPDATED_DATE = #{updatedDate,jdbcType=DATE}
		</if>
		<if test="primaryCProdName != null">
			and PRIMARY_C_PROD_NAME = #{primaryCProdName,jdbcType=VARCHAR}
		</if>
		<if test="channel != null">
			and CHANNEL = #{channel,jdbcType=VARCHAR}
		</if>
		<if test="createdDate != null">
			and CREATED_DATE = #{createdDate,jdbcType=DATE}
		</if>
		<if test="cBsnsTyp != null">
			and C_BSNS_TYP = #{cBsnsTyp,jdbcType=VARCHAR}
		</if>
		<if test="tCommission != null">
			and T_COMMISSION = #{tCommission,jdbcType=DOUBLE}
		</if>
		<if test="rpPrmTotalAll != null">
			and RP_PRM_TOTAL_ALL = #{rpPrmTotalAll,jdbcType=DOUBLE}
		</if>
		</where>
	</sql>
	
	<!-- 
		insert操作给定的参数是java.util.Map<String,Object>类型的对象，
		与<sql id="Insert_Base_values">中配置的列一致
	-->
	<insert id="insertVo" parameterType="com.sinosafe.xszc.report.vo.ReportFoundationMedium" >
    insert into REPORT_MONTH_BIZ_ORIGIN (
		<include refid="Base_Column_List" />
    )
	values (
		<include refid="Insert_Base_values" />
    )
	</insert>
	
	<!-- 
		insert操作给定的参数是java.util.Map<String,Object>类型的对象，
		与<sql id="Insert_Base_values">中配置的列一致
	-->
	<insert id="insert" parameterType="map" >
    insert into REPORT_MONTH_BIZ_ORIGIN (
		<include refid="Base_Column_List" />
    )
	values (
		<include refid="Insert_Base_values" />
    )
	</insert>

<!-- 
	<delete id="deleteByDataKey" parameterType="long">
    delete from REPORT_MONTH_BIZ_ORIGIN
    where PK_SERIAL = #{data}
	</delete>
 -->



	<!-- 条件查询总数据量 -->
	<select id="queryCount" parameterType="map" resultType="long">
	select count(1)
	from REPORT_MONTH_BIZ_ORIGIN <include refid="Base_Where_Sql" />
	</select>
	<!-- 条件查询总数据量new -->
	<select id="queryCountNew" parameterType="map" resultType="long">
	select count(1)
	from ( <include refid="bizorigin_Sql" />)
	</select>
	
	
	<!-- 条件查询总数据量 -->
	<select id="queryCountVo" parameterType="com.sinosafe.xszc.report.vo.ReportFoundationMedium" resultType="long">
	select count(1)
	from REPORT_MONTH_BIZ_ORIGIN <include refid="Base_Where_Sql" />
	</select>

	<!-- 单独条件分页查询语句,注意下面语句中的endpoint和startpoint这两个名称不可修改，否则将导致sql错误 -->
	<select id="queryListPageVo" parameterType="map" resultMap="BaseResultVo">
	select * from (
		select a.*,rownum rn from (
		select 
		<include refid="Base_Column_List"/>
		from REPORT_MONTH_BIZ_ORIGIN
		<include refid="Base_Where_Sql"/>
		) a where rownum &lt;= #{endpoint}
	) where rn &gt;= #{startpoint}
	</select>
	
	<!-- 条件查询 -->
	<select id="query" parameterType="map" resultMap="BaseResultMap">
		select 
		<include refid="Base_Column_List"/>
		from REPORT_MONTH_BIZ_ORIGIN
		<include refid="Base_Where_Sql"/>
	</select>
	
	<!-- 条件查询 -->
	<select id="queryVo" parameterType="map" resultMap="BaseResultVo">
		select 
		<include refid="Base_Column_List"/>
		from REPORT_MONTH_BIZ_ORIGIN
		<include refid="Base_Where_Sql"/>
	</select>
	
	<!-- 综合条件分页查询语句,注意下面语句中的endpoint和startpoint这两个名称不可修改，否则将导致sql错误 -->
	<select id="queryPage" parameterType="map" resultMap="BaseResultMap">
	<choose>
		<when test="endpoint!=null and endpoint != '' and startpoint != null and startpoint != ''">
		select * from (
			select a.*,rownum rn from (
				select 
				<include refid="Base_Column_List"/>
				from REPORT_MONTH_BIZ_ORIGIN
				<include refid="Base_Where_Sql"/>
			) a where rownum &lt;= #{endpoint}
		) where rn &gt;= #{startpoint}
		</when>
		<otherwise>
		<!-- 这里的"count"重命名不可修改，否则会出现异常 -->
		select count(1) "count" from REPORT_MONTH_BIZ_ORIGIN <include refid="Base_Where_Sql" />
		</otherwise>
	</choose>
	
	select * from (
		select a.*,rownum rn from (
		select 
		<include refid="Base_Column_List"/>
		from REPORT_MONTH_BIZ_ORIGIN
		<include refid="Base_Where_Sql"/>
		) a where rownum &lt;= #{endpoint}
	) where rn &gt;= #{startpoint}
	</select>
	
	<!-- 综合条件分页查询语句,注意下面语句中的endpoint和startpoint这两个名称不可修改，否则将导致sql错误 -->
	<select id="queryPageVo" parameterType="map" resultMap="BaseResultVo">
	<choose>
		<when test="endpoint!=null and endpoint != '' and startpoint != null and startpoint != ''">
		select * from (
			select a.*,rownum rn from (
				select 
				<include refid="Base_Column_List"/>
				from REPORT_MONTH_BIZ_ORIGIN
				<include refid="Base_Where_Sql"/>
			) a where rownum &lt;= #{endpoint}
		) where rn &gt;= #{startpoint}
		</when>
		<otherwise>
		<!-- 这里的"count"重命名不可修改，否则会出现异常 -->
		select count(1) "count" from REPORT_MONTH_BIZ_ORIGIN <include refid="Base_Where_Sql" />
		</otherwise>
	</choose>
	
	select * from (
		select a.*,rownum rn from (
		select 
		<include refid="Base_Column_List"/>
		from REPORT_MONTH_BIZ_ORIGIN
		<include refid="Base_Where_Sql"/>
		) a where rownum &lt;= #{endpoint}
	) where rn &gt;= #{startpoint}
	</select>
	
	
	<select id="queryRP" parameterType="map" resultMap="BaseResultMap">
		select *
	  		from (select case
	                 when  grouping_id(c_bsns_typ, c_cha_type,channel) = 1 then
	                  'Subtotal'
	                 when  grouping_id(c_bsns_typ, c_cha_type,channel) = 3 then
	                  'counts'
	                 when grouping_id(c_bsns_typ, c_cha_type,channel) = 7 then
	                  'Total'
	                 else
	                  'not'
	               end counts,
	               decode(c_bsns_typ,'19001直销业务','01直接业务','19007电销业务','01直接业务','19008店面直销','01直接业务','19002代理业务','02间接业务','19003经纪业务','02间接业务',null,'合计','03其它业务') as "type",
	               c_bsns_typ,
	               c_cha_type||decode(channel,null,null,':'||channel) as c_cha_type,
	               to_char(sum(comp_take_in), 'fm99999999999990.00') as "compTakeIn",
	               to_char(sum(comp_commision), 'fm99999999999990.00') as "compCommision",
	               to_char(sum(comp_real_commision), 'fm99999999999990.00') as "compRealCommision",
	               to_char(sum(farm_take_in), 'fm99999999999990.00') as "farmTakeIn",
	               to_char(sum(farm_commision), 'fm99999999999990.00') as "farmCommision",
	               to_char(sum(farm_real_commision), 'fm99999999999990.00') as "farmRealCommision",
	               to_char(sum(busi_take_in), 'fm99999999999990.00') as "busiTakeIn",
	               to_char(sum(busi_commision), 'fm99999999999990.00') as "busiCommision",
	               to_char(sum(busi_real_commision), 'fm99999999999990.00') as "busiRealCommision",
	               to_char(sum(trans_take_in), 'fm99999999999990.00') as "transTakeIn",
	               to_char(sum(trans_commision), 'fm99999999999990.00') as "transCommision",
	               to_char(sum(trans_real_commision), 'fm99999999999990.00') as "transRealCommision",
	               to_char(sum(project_take_in), 'fm99999999999990.00') as "projectTakeIn",
	               to_char(sum(project_commision), 'fm99999999999990.00') as "projectCommision",
	               to_char(sum(project_real_commision), 'fm99999999999990.00') as "projectRealCommision",
	               to_char(sum(duty_take_in), 'fm99999999999990.00') as "dutyTakeIn",
	               to_char(sum(duty_commision), 'fm99999999999990.00') as "dutyCommision",
	               to_char(sum(duty_real_commision), 'fm99999999999990.00') as "dutyRealCommision",
	               to_char(sum(credit_take_in), 'fm99999999999990.00') as "creditTakeIn",
	               to_char(sum(credit_commision), 'fm99999999999990.00') as "creditCommision",
	               to_char(sum(credit_real_commision), 'fm99999999999990.00') as "creditRealCommision",
	               to_char(sum(guarantee_take_in), 'fm99999999999990.00') as "guaranteeTakeIn",
	               to_char(sum(guarantee_commision), 'fm99999999999990.00') as "guaranteeCommision",
	               to_char(sum(guarantee_real_commision), 'fm99999999999990.00') as "guaranteeRealCommision",
	               to_char(sum(ship_take_in), 'fm99999999999990.00') as "shipTakeIn",
	               to_char(sum(ship_commision), 'fm99999999999990.00') as "shipCommision",
	               to_char(sum(ship_real_commision), 'fm99999999999990.00') as "shipRealCommision",
	               to_char(sum(cargo_take_in), 'fm99999999999990.00') as "cargoTakeIn",
	               to_char(sum(cargo_commision), 'fm99999999999990.00') as "cargoCommision",
	               to_char(sum(cargo_real_commision), 'fm99999999999990.00') as "cargoRealCommision",
	               to_char(sum(special_take_in), 'fm99999999999990.00') as "specialTakeIn",
	               to_char(sum(special_commision), 'fm99999999999990.00') as "specialCommision",
	               to_char(sum(special_real_commision), 'fm99999999999990.00') as "specialRealCommision",
	               to_char(sum(farming_take_in), 'fm99999999999990.00') as "farmingTakeIn",
	               to_char(sum(farming_commision), 'fm99999999999990.00') as "farmingCommision",
	               to_char(sum(farming_real_commision), 'fm99999999999990.00') as "farmingRealCommision",
	               to_char(sum(health_take_in), 'fm99999999999990.00') as "healthTakeIn",
	               to_char(sum(health_commision), 'fm99999999999990.00') as "healthCommision",
	               to_char(sum(health_real_commision), 'fm99999999999990.00') as "healthRealCommision",
	               to_char(sum(hurt_take_in), 'fm99999999999990.00') as "hurtTakeIn",
	               to_char(sum(hurt_commision), 'fm99999999999990.00') as "hurtCommision",
	               to_char(sum(hurt_real_commision), 'fm99999999999990.00') as "hurtRealCommision",
	               to_char(sum(other_take_in), 'fm99999999999990.00') as "otherTakeIn",
	               to_char(sum(other_commision), 'fm99999999999990.00') as "otherCommision",
	               to_char(sum(other_real_commision), 'fm99999999999990.00') as "otherRealCommision",
	               to_char((sum(comp_take_in) + sum(farm_take_in) +
	                       sum(busi_take_in) + sum(trans_take_in) +
	                       sum(project_take_in) + sum(duty_take_in) +
	                       sum(credit_take_in) + sum(guarantee_take_in) +
	                       sum(ship_take_in) + sum(cargo_take_in) +
	                       sum(special_take_in) + sum(farming_take_in) +
	                       sum(health_take_in) + sum(hurt_take_in) +
	                       sum(other_take_in)),
	                       'fm99999999999990.00') as "totalTakeIn",
	               to_char((sum(comp_commision) + sum(farm_commision) +
	                       sum(busi_commision) + sum(trans_commision) +
	                       sum(project_commision) + sum(duty_commision) +
	                       sum(credit_commision) + sum(guarantee_commision) +
	                       sum(ship_commision) + sum(cargo_commision) +
	                       sum(special_commision) + sum(farming_commision) +
	                       sum(health_commision) + sum(hurt_commision) +
	                       sum(other_commision)),
	                       'fm99999999999990.00') as "totalCommision",
	               to_char((sum(comp_real_commision) + sum(farm_real_commision) +
	                       sum(busi_real_commision) + sum(trans_real_commision) +
	                       sum(project_real_commision) +
	                       sum(duty_real_commision) +
	                       sum(credit_real_commision) +
	                       sum(guarantee_real_commision) +
	                       sum(ship_real_commision) + sum(cargo_real_commision) +
	                       sum(special_real_commision) +
	                       sum(farming_real_commision) +
	                       sum(health_real_commision) +
	                       sum(hurt_real_commision) + sum(other_real_commision)),
	                       'fm99999999999990.00') as "totalRealCommision"
	         
	                  from (select t.c_bsns_typ,
	                               t.c_cha_type,
	                               t.channel,
	                               case
	                                 when t.primary_c_prod_name = '企业财产险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end comp_take_in /* 企业财产险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '企业财产险' then
	                                  t.commission
	                                 else
	                                  0
	                               end comp_commision /* 企业财产险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '企业财产险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end comp_real_commision /*企业财产险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '家庭及个人财产险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end farm_take_in /*家庭及个人财产险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '家庭及个人财产险' then
	                                  t.commission
	                                 else
	                                  0
	                               end farm_commision /*家庭及个人财产险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '家庭及个人财产险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end farm_real_commision /*家庭及个人财产险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '商业车险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end busi_take_in /*商业车险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '商业车险' then
	                                  t.commission
	                                 else
	                                  0
	                               end busi_commision /*商业车险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '商业车险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end busi_real_commision /*商业车险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '交强险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end trans_take_in /* 交强险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '交强险' then
	                                  t.commission
	                                 else
	                                  0
	                               end trans_commision /* 交强险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '交强险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end trans_real_commision /*交强险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '工程险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end project_take_in /* 工程保险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '工程险' then
	                                  t.commission
	                                 else
	                                  0
	                               end project_commision /* 工程保险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '工程险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end project_real_commision /*工程保险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '责任险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end duty_take_in /* 责任保险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '责任险' then
	                                  t.commission
	                                 else
	                                  0
	                               end duty_commision /* 责任保险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '责任险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end duty_real_commision /*责任保险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '信用险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end credit_take_in /* 信用险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '信用险' then
	                                  t.commission
	                                 else
	                                  0
	                               end credit_commision /* 信用险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '信用险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end credit_real_commision /*信用险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '保证险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end guarantee_take_in /* 保证险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '保证险' then
	                                  t.commission
	                                 else
	                                  0
	                               end guarantee_commision /* 保证险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '保证险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end guarantee_real_commision /*保证险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '船舶险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end ship_take_in /* 船舶险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '船舶险' then
	                                  t.commission
	                                 else
	                                  0
	                               end ship_commision /* 船舶险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '船舶险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end ship_real_commision /*船舶险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '货物运输险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end cargo_take_in /* 货物运输险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '货物运输险' then
	                                  t.commission
	                                 else
	                                  0
	                               end cargo_commision /* 货物运输险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '货物运输险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end cargo_real_commision /*货物运输险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '特殊风险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end special_take_in /* 特殊风险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '特殊风险' then
	                                  t.commission
	                                 else
	                                  0
	                               end special_commision /* 特殊风险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '特殊风险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end special_real_commision /*特殊风险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '农业险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end farming_take_in /* 农业险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '农业险' then
	                                  t.commission
	                                 else
	                                  0
	                               end farming_commision /* 农业险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '农业险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end farming_real_commision /*农业险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '健康险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end health_take_in /* 健康险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '健康险' then
	                                  t.commission
	                                 else
	                                  0
	                               end health_commision /* 健康险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '健康险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end health_real_commision /*健康险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '意外伤害险' then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end hurt_take_in /* 意外伤害险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name = '意外伤害险' then
	                                  t.commission
	                                 else
	                                  0
	                               end hurt_commision /* 意外伤害险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name = '意外伤害险' then
	                                  t.t_commission
	                                 else
	                                  0
	                               end hurt_real_commision /*意外伤害险-实收佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name not in
	                                      ('企业财产险',
	                                       '家庭及个人财产险',
	                                       '商业车险',
	                                       '交强险',
	                                       '工程险',
	                                       '责任险',
	                                       '信用险',
	                                       '保证险',
	                                       '船舶险',
	                                       '货物运输险',
	                                       '特殊风险',
	                                       '农业险',
	                                       '健康险',
	                                       '意外伤害险') then
	                                  t.rp_prm_total_all
	                                 else
	                                  0
	                               end other_take_in /* 其他险-保费收入*/,
	                               case
	                                 when t.primary_c_prod_name not in
	                                      ('企业财产险',
	                                       '家庭及个人财产险',
	                                       '商业车险',
	                                       '交强险',
	                                       '工程险',
	                                       '责任险',
	                                       '信用险',
	                                       '保证险',
	                                       '船舶险',
	                                       '货物运输险',
	                                       '特殊风险',
	                                       '农业险',
	                                       '健康险',
	                                       '意外伤害险') then
	                                  t.commission
	                                 else
	                                  0
	                               end other_commision /* 其他险-佣金手续费*/,
	                               case
	                                 when t.primary_c_prod_name not in
	                                      ('企业财产险',
	                                       '家庭及个人财产险',
	                                       '商业车险',
	                                       '交强险',
	                                       '工程险',
	                                       '责任险',
	                                       '信用险',
	                                       '保证险',
	                                       '船舶险',
	                                       '货物运输险',
	                                       '特殊风险',
	                                       '农业险',
	                                       '健康险',
	                                       '意外伤害险') then
	                                  t.t_commission
	                                 else
	                                  0
	                               end other_real_commision /*其他险-实收佣金手续费*/
	                          from REPORT_MONTH_BIZ_ORIGIN t
	  <!--left join department d
	         on d.inter_code = t.dept_code
	  left join department de
	         on de.inter_code = substr(t.parent_dept,1,3)-->
	 <where>
	 	<choose>
		   <when test="deptName != null and deptName !='' ">
		      and t.dept_code = f_get_inter_dept(#{deptName})
		   </when>
		   <when test="parentDept != null and parentDept !='' ">
		      and t.parent_dept like f_get_inter_dept(#{parentDept}) || '%' 
		   </when>
		   <otherwise></otherwise>
		</choose>
	 	<if test="reportMonth != null and reportMonth != ''">
			and to_date(substr(REPORT_DAY,1,7),'yyyy-mm') = to_date(#{reportMonth,jdbcType=VARCHAR},'yyyymm')
		</if>
	 </where>        
	 	) group by rollup(c_bsns_typ, c_cha_type,channel)) t
	 where t.c_cha_type is null or (t.c_bsns_typ = '19002代理业务' and t.c_cha_type not like '%其它') or t.c_cha_type = '兼业代理:其它'
	   order by t."type",t.c_bsns_typ,t.c_cha_type
	</select>
	
	<select id="querybizorigin" parameterType="map" resultMap="bizOriginNew">
<include refid="bizorigin_Sql" />
	</select>
	<sql id="bizorigin_Sql">
		select*from(		
select*From(
select t.c_bsns,t.c_bsns_typ,t.channel_type,

(case trim(t.C_BSNS) when '间接业务' then '2' when '直接业务' then '1' when '其他业务'then '3' else '4' end ) seq,
(case nvl(t.channel_type,'8') when'个人代理' then '1'when'其它兼业'then '2'when '车行业务' then '3'when '银邮业务'then '4'when '交叉销售'then '5'when '专业代理' then '6' when  '8' then '8'else '7'end ) seq2,

to_char(sum(qcx_prm_total),'fm9999999999990.00') as "qcxprmtotal",
to_char(sum(qcx_cmm_amt),'fm9999999999990.00') as"qcxcmmamt",
to_char(sum(qcx_paid_amt),'fm9999999999990.00') as"qcxpaidamt",

to_char(sum(jt_prm_total),'fm9999999999990.00') as "jtprmtotal",
to_char(sum(jt_cmm_amt),'fm9999999999990.00') as"jtcmmamt",
to_char(sum(jt_paid_amt),'fm9999999999990.00') as"jtpaidamt",

to_char(sum(syx_prm_total),'fm9999999999990.00') as"syxprmtotal",
to_char(sum(syx_cmm_amt),'fm9999999999990.00') as"syxcmmamt",
to_char(sum(syx_paid_amt),'fm9999999999990.00') as"syxpaidamt",

to_char(sum(jqx_prm_total),'fm9999999999990.00') as"jqxprmtotal",
to_char(sum(jqx_cmm_amt),'fm9999999999990.00') as"jqxcmmamt",
to_char(sum(jqx_paid_amt),'fm9999999999990.00') as"jqxpaidamt",

to_char(sum(gcx_prm_total),'fm9999999999990.00') as"gcxprmtotal",
to_char(sum(gcx_cmm_amt),'fm9999999999990.00') as"gcxcmmamt",
to_char(sum(gcx_paid_amt),'fm9999999999990.00') as"gcxpaidamt",

to_char(sum(zrx_prm_total),'fm9999999999990.00') as"zrxprmtotal",
to_char(sum(zrx_cmm_amt),'fm9999999999990.00') as"zrx_cmm_amt",
to_char(sum(zrx_paid_amt),'fm9999999999990.00') as"zrxpaidamt",

to_char(sum(xybz_prm_total),'fm9999999999990.00') as"xybzprmtotal",
to_char(sum(xybz_cmm_amt),'fm9999999999990.00') as"xybzcmmamt",
to_char(sum(xybz_paid_amt),'fm9999999999990.00') as"xybzpaidamt",

to_char(sum(bzbz_prm_total),'fm9999999999990.00') as"bzbzprmtotal",
to_char(sum(bzbz_cmm_amt),'fm9999999999990.00') as"bzbzcmmamt",
to_char(sum(bzbz_paid_amt),'fm9999999999990.00') as"bzbzpaidamt",

to_char(sum(cbx_prm_total),'fm9999999999990.00') as"cbxprmtotal",
to_char(sum(cbx_cmm_amt),'fm9999999999990.00') as"cbxcmmamt",
to_char(sum(cbx_paid_amt),'fm9999999999990.00') as"cbxpaidamt",

to_char(sum(hyx_prm_total),'fm9999999999990.00') as"hyxprmtotal",
to_char(sum(hyx_cmm_amt),'fm9999999999990.00') as"hyxcmmamt",
to_char(sum(hyx_paid_amt),'fm9999999999990.00') as"hyxpaidamt",

to_char(sum(tsx_prm_total),'fm9999999999990.00') as"tsxprmtotal",
to_char(sum(tsx_cmm_amt),'fm9999999999990.00') as"tsxcmmamt",
to_char(sum(tsx_paid_amt),'fm9999999999990.00') as"tsxpaidamt",

to_char(sum(nyx_prm_total),'fm9999999999990.00') as"nyxprmtotal",
to_char(sum(nyx_cmm_amt),'fm9999999999990.00') as"nyxcmmamt",
to_char(sum(nyx_paid_amt),'fm9999999999990.00') as"nyxpaidamt",

to_char(sum(jkx_prm_total),'fm9999999999990.00') as"jkxprmtotal",
to_char(sum(jkx_cmm_amt),'fm9999999999990.00') as"jkxcmmamt",
to_char(sum(jkx_paid_amt),'fm9999999999990.00') as"jkxpaidamt",

to_char(sum(ywx_prm_total),'fm9999999999990.00') as"ywxprmtotal",
to_char(sum(ywx_cmm_amt),'fm9999999999990.00') as"ywxcmmamt",
to_char(sum(ywx_paid_amt),'fm9999999999990.00') as"ywxpaidamt",

to_char(sum(rp_prm_total),'fm9999999999990.00') as"rpprmtotal",
to_char(sum(n_cmm_amt),'fm9999999999990.00') as"ncmmamt",
to_char(sum(n_paid_amt),'fm9999999999990.00') as"npaidamt"

FROM(
select t.c_bsns,t.c_bsns_typ,t.channel_type,
t.qcx_prm_total,t.qcx_cmm_amt,t.qcx_paid_amt,
t.jt_prm_total,t.jt_cmm_amt,t.jt_paid_amt,
t.syx_prm_total,t.syx_cmm_amt,t.syx_paid_amt,
t.jqx_prm_total,t.jqx_cmm_amt,t.jqx_paid_amt,
t.gcx_prm_total,t.gcx_cmm_amt,t.gcx_paid_amt,
t.zrx_prm_total,t.zrx_cmm_amt,t.zrx_paid_amt,
t.xybz_prm_total,t.xybz_cmm_amt,t.xybz_paid_amt,
t.bzbz_prm_total,t.bzbz_cmm_amt,t.bzbz_paid_amt,
t.cbx_prm_total,t.cbx_cmm_amt,t.cbx_paid_amt,
t.hyx_prm_total,t.hyx_cmm_amt,t.hyx_paid_amt,
t.tsx_prm_total,t.tsx_cmm_amt,t.tsx_paid_amt,
t.nyx_prm_total,t.nyx_cmm_amt,t.nyx_paid_amt,
t.jkx_prm_total,t.jkx_cmm_amt,t.jkx_paid_amt,
t.ywx_prm_total,t.ywx_cmm_amt,t.ywx_paid_amt,
t.rp_prm_total,t.n_cmm_amt,t.n_paid_amt 
from REPORT_MONTH_BIZ_ORIGIN_NEW t 
<where>
	<if test="reportMonth !=null and reportMonth!=''">
and REPORT_month=#{reportMonth}
	</if>
	<if test="fComName !=null and fComName!=''">
		and F_COM_NAME like '%'|| #{fComName} ||'%'
		
	</if>
</where> 
) t
group by rollup( c_bsns,c_bsns_typ,channel_type) )order by seq, c_bsns,c_bsns_typ,seq2)where
(c_bsns_typ='19001直销业务'and channel_type is not null)
or (c_bsns_typ='19007电销业务'and channel_type is not null)
or (c_bsns_typ='19008店面直销'and channel_type is not null)
or (c_bsns_typ='19003经纪业务'and channel_type is not null)
or (c_bsns='其他业务'and channel_type is not null and c_bsns_typ is not null)
or c_bsns_typ='19002代理业务'
or (c_bsns='直接业务'and channel_type is  null and c_bsns_typ is  null)
or (c_bsns='间接业务'and channel_type is  null and c_bsns_typ is  null)
or (c_bsns is null and channel_type is  null and c_bsns_typ is  null)
		
		
		
	</sql>
	
</mapper>
